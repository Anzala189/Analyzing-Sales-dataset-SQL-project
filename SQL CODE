-- Find out how much Wholesale net revenue each product_line generated per month per warehouse in the dataset.The query should be saved as revenue_by_product_line using the SQL cell provided, and contain the following:
-- product_line, month: displayed as 'June', 'July', and 'August',warehouse, and net_revenue: the sum of total minus the sum of payment_fee.The results should be sorted by product_line and month, followed by net_revenue in descending order.

-- Create the view with net revenue per product line, month, and warehouse
-- Step 1: create a subquery that calculates the month number
SELECT 
    product_line,
    CASE month_num
        WHEN 6 THEN 'June'
        WHEN 7 THEN 'July'
        WHEN 8 THEN 'August'
    END AS month,
    warehouse,
    SUM(total) - SUM(payment_fee) AS net_revenue
FROM (
    SELECT 
        product_line,
        warehouse,
        total,
        payment_fee,
        MONTH(date) AS month_num
    FROM data_sales
    WHERE client_type = 'Wholesale'
      AND MONTH(date) IN (6,7,8)
) AS t
GROUP BY 
    product_line,
    warehouse,
    month_num
ORDER BY 
    product_line,
    month_num DESC, net_revenue DESC;
